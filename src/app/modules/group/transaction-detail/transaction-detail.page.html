<ion-header class="ion-no-border">
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-back-button *ngIf="!editing" defaultHref="/group/{{groupId}}"></ion-back-button>
            <ion-button (click)="toggleEditing()" *ngIf="editing">
                <ion-label>{{'actions.cancel' | translate}}</ion-label>
            </ion-button>
        </ion-buttons>
        <ion-buttons slot="end">
            <ion-button (click)="toggleEditing()" *ngIf="!editing">
                <ion-label>{{'actions.edit' | translate}}</ion-label>
            </ion-button>
            <ion-button (click)="editTransaction()" *ngIf="editing">
                <ion-label>{{'actions.save' | translate}}</ion-label>
            </ion-button>
        </ion-buttons>
    </ion-toolbar>
</ion-header>

<ion-content>
    <div *ngIf="transaction?.createdBy as account" class="createdBy">
        <ion-avatar>
            <img *ngIf="account.photoUrl" alt="" src="{{account.photoUrl}}">
            <img *ngIf="!account.photoUrl" alt="" src="https://ionicframework.com/docs/demos/api/avatar/avatar.svg">
        </ion-avatar>
        <ion-label>
            <h1>{{account.name}}</h1>
            <p>Op {{transaction.createdAt.toDate().toLocaleString()}}</p>
        </ion-label>
    </div>
    <ion-list *ngIf="transaction?.items">
        <ion-item *ngFor="let item of transaction.items; index as i">
            <ion-label>
                <h2>{{item.amount}} {{item.product.name}} voor {{getPriceString(item.product.price * item.amount)}}</h2>
                <p>
                    Gestreept op {{item.account.name}}
                </p>
            </ion-label>
            <ion-fab-button (click)="removeItem(item)" *ngIf="editing" [attr.disabled]="item.amount === 0"
                            color="danger" size="small">
                <ion-icon name="remove-outline"></ion-icon>
            </ion-fab-button>
            <ion-fab-button (click)="addItem(item)" *ngIf="editing" [attr.disabled]="item.amount >= itemsAmount[i]"
                            color="success"
                            size="small">
                <ion-icon name="add-outline"></ion-icon>
            </ion-fab-button>
        </ion-item>
    </ion-list>

    <ion-fab *ngIf="editing" horizontal="end" slot="fixed" vertical="bottom">
        <ion-fab-button (click)="deleteTransaction()" color="danger">
            <ion-icon name="trash-outline"></ion-icon>
        </ion-fab-button>
    </ion-fab>
</ion-content>
